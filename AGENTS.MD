<!-- TODO_MANAGEMENT_INSTRUCTIONS -->

# CRITICAL: Task Management System

**Using markdown file in .factory directory for task tracking instead of MCP task-manager tools.**

## MANDATORY TODO WORKFLOW

**BEFORE responding to ANY request, you MUST:**

1. **Read `.factory/tasks.md` first** - Check current task status before doing ANYTHING
2. **Plan work based on existing tasks** - Reference what's already tracked
3. **Update `.factory/tasks.md`** - Mark tasks in_progress when starting, completed when done
4. **NEVER work without consulting the task file first**

## CRITICAL TODO SYSTEM RULES

- **Only ONE task can have status "In Progress" at a time** - No exceptions
- **Mark tasks "In Progress" BEFORE starting work** - Not during or after
- **Complete tasks IMMEDIATELY when finished** - Don't batch completions
- **Break complex requests into specific, actionable tasks** - No vague tasks
- **Reference existing tasks when planning new work** - Don't duplicate

## MANDATORY VISUAL DISPLAY

**ALWAYS display the complete task list from `.factory/tasks.md` AFTER reading or updating:**

```
# Current Tasks

## In Progress
- üîÑ Implement login form

## Pending
- ‚è≥ Add validation
- ‚è≥ Write tests

## Completed
- ‚úÖ Research existing patterns
```

Icons: ‚úÖ = completed | üîÑ = in progress | ‚è≥ = pending

**NEVER just say "updated tasks"** - Show the full list every time.

## CRITICAL ANTI-PATTERNS

**NEVER explore/research before creating tasks:**
- ‚ùå "Let me first understand the codebase..." ‚Üí starts exploring
- ‚úÖ Create task: "Analyze current codebase structure" ‚Üí mark in_progress ‚Üí explore

**NEVER do "preliminary investigation" outside tasks:**
- ‚ùå "I'll check what libraries you're using..." ‚Üí starts searching
- ‚úÖ Create task: "Audit current dependencies" ‚Üí track it ‚Üí investigate

**NEVER work on tasks without marking them in_progress:**
- ‚ùå Creating tasks then immediately starting work without marking in_progress
- ‚úÖ Create tasks ‚Üí Mark first as in_progress ‚Üí Start work

**NEVER mark incomplete work as completed:**
- ‚ùå Tests failing but marking "Write tests" as completed
- ‚úÖ Keep as in_progress, create new task for fixing failures

## FORBIDDEN PHRASES

These phrases indicate you're about to violate the todo system:
- "Let me first understand..."
- "I'll start by exploring..."
- "Let me check what..."
- "I need to investigate..."
- "Before we begin, I'll..."

**Correct approach:** CREATE TASK FIRST, mark it in_progress, then investigate.

## TASK FILE REFERENCE

```markdown
# Current Tasks

## In Progress
- üîÑ Task name

## Pending  
- ‚è≥ Task name
- ‚è≥ Another task

## Completed
- ‚úÖ Completed task
```

<!-- END_TODO_MANAGEMENT_INSTRUCTIONS -->

---

## üéØ CRITICAL: 80% Test Coverage Requirement

**MANDATORY POLICY:** ModPorter-AI requires maintaining ‚â•80% test coverage for all components.

### Coverage Standards:
- **Backend Services**: Must maintain ‚â•80% line coverage
- **AI Engine**: Must maintain ‚â•80% line coverage  
- **Frontend**: Must maintain ‚â•80% branch coverage
- **Integration Tests**: Full end-to-end workflow coverage

### Quality Gates:
- **CI/CD Pipeline**: Automatically fails if coverage drops below 80%
- **Code Review**: PRs must demonstrate coverage improvements
- **Coverage Regression**: New code must include corresponding tests
- **Critical Paths**: Core business logic requires ‚â•95% coverage

### Coverage Enforcement:
- **No Threshold Reductions**: Coverage targets are non-negotiable
- **Automated Checks**: GitHub Actions enforces coverage in all PRs
- **Coverage Reports**: Generated and reviewed in every deployment
- **Quality Metrics**: Coverage directly tied to deployment readiness

**VIOLATION CONSEQUENCES:**
- PRs with <80% coverage will be automatically rejected
- Coverage drops trigger deployment rollbacks
- Teams must fix coverage issues before merging features
- Chronic low coverage areas require immediate test investment

### Testing Priority Framework:
1. **Tier 1 (Critical)**: API endpoints, business logic, database operations
2. **Tier 2 (High)**: Service integrations, authentication, validation
3. **Tier 3 (Standard)**: Utility functions, helper classes, configuration
4. **Tier 4 (Low)**: Development tools, debugging utilities, experimental features

**TEST-FIRST DEVELOPMENT:** All new features must include comprehensive test coverage before implementation review.

---

## üõ°Ô∏è Droid Shield Bypass Methods

When Droid Shield detects false positives, use these methods to bypass:

### 1. **Create `.droidignore` File**
Create a file to exclude known false positives:
```bash
# Add to .droidignore
backend/src/utils/graph_cache.py
*.env.example
docker-compose*.yml
```

### 2. **Git Attributes Configuration**
Mark files as safe in `.gitattributes`:
```bash
# Add to .gitattributes
backend/src/utils/*.py linguist-generated=false
*.env.example linguist-generated=false
docker-compose*.yml linguist-generated=false
```

### 3. **Settings Toggle**
Run `/settings` command and toggle "Droid Shield" option to disable it temporarily.

### 4. **Manual Commit**
Commit files outside the environment:
```bash
git add <problematic-file>
git commit -m "feat: add utility file"
git push origin <branch>
```

### 5. **Environment Variables**
If supported, configure in `.env.local`:
```bash
DROID_SHIELD_EXCLUDES=backend/src/utils/graph_cache.py,*.env.example
DROID_SHIELD_MODE=permissive
```

### 6. **Inline Comments**
Add explanatory comments for legitimate use of flagged patterns:
```python
# Non-cryptographic use of SHA-256 for cache key generation only
key_hash = hashlib.sha256(key_str.encode()).hexdigest()
```

---
